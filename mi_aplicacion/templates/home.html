{% extends "layouts/base_minimal.html" %}

{% block title %}Dashboard - Planta Empaques{% endblock %}

{% block head_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/css4.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/home_styles.css') }}">
{% endblock %}

{% block body_content %}
    <header class="home-header">
        <div class="logo-section">
            <div class="logo-container">
                <a href="{{ url_for('main.home') }}" class="logo-area">
                    <img src="{{ url_for('static', filename='img/logo.png') }}" alt="Logo Empresa">
                </a>
            </div>
            <div class="brand-info">
                <h1>Planta Empaques</h1>
            </div>
        </div>
        <div class="user-section">
            <div class="user-profile">
                <div class="user-avatar">{{ username[0].upper() }}</div>
                <div class="user-details">
                    <div class="user-name">{{ username }}</div>
                </div>
            </div>
            <a href="{{ url_for('main.logout') }}" class="logout-button">
                <i class="fas fa-sign-out-alt"></i>
                Salir
            </a>
        </div>
    </header>

    <main class="home-main-content">
        <div class="welcome-container fade-in-up">
            <h1 class="welcome-title">Hola, <strong>{{ username }}</strong></h1>
        </div>

        <div class="process-section">
            <div class="section-header">
                <h2 class="section-title">Procesos Disponibles</h2>
                <span class="process-count">{{ procesos|length }} procesos</span>
            </div>

            <div class="process-grid">
                {% for proceso in procesos %}
                <a href="{{ proceso.url }}" class="process-card">
                    <div class="process-header">
                        <div class="icon-container" style="color: {{ proceso.color_icono }};">
                            <i class="{{ proceso.icono }}"></i>
                        </div>
                        <div class="process-info">
                            <h3>{{ proceso.nombre }}</h3>
                            <div class="process-status">
                                <span class="status-dot"></span>
                                Activo
                            </div>
                        </div>
                    </div>
                    <p>{{ proceso.descripcion }}</p>
                    <span class="btn-acceder">Acceder al Proceso</span>
                </a>
                {% endfor %}
            </div>
        </div>
    </main>
    <div class="firma-hm">Hm</div>

{% endblock %}

{% block scripts %}
<script>
    document.body.classList.add('home-page-body');

    document.addEventListener('DOMContentLoaded', function() {
        // Add smooth interactions to process cards
        const processCards = document.querySelectorAll('.process-card');
        processCards.forEach(function(card) {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-4px) scale(1.02)';
            });
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(-4px) scale(1)';
            });
            card.addEventListener('mousedown', function() {
                this.style.transform = 'translateY(-2px) scale(0.98)';
            });
            card.addEventListener('mouseup', function() {
                this.style.transform = 'translateY(-4px) scale(1.02)';
            });
        });

        // Add keyboard navigation (opcional)
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                document.activeElement.blur();
            }
        });

        // Animación de entrada de los cards
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    if (!entry.target.classList.contains('animated')) {
                         entry.target.classList.add('animated');
                    }
                }
            });
        }, {
            threshold: 0.1,
            rootMargin: '0px 0px -20px 0px'
        });

        processCards.forEach(card => {
            observer.observe(card);
        });
    });

    // Process access tracking (opcional)
    function trackProcessAccess(processName) {
        console.log('Proceso accedido:', processName);
        // Aquí podrías enviar datos de analytics al backend si quisieras
    }

    document.querySelectorAll('.process-card').forEach(function(card) {
        card.addEventListener('click', function() {
            const processName = this.querySelector('h3').textContent;
            trackProcessAccess(processName);
        });
    });
</script>
{% endblock %}
